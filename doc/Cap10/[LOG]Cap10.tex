\documentclass{article}

\input{../header.tex}

\begin{document}

\section{Restrições ativas}

Regras de propagação como as vistas no Capítulo passado possibilitam o que é chamado ``restrição
ativa''. Sem essas regras de
propagação, tínhamos que buscar a solução de nossos problemas ``na mão'', isto é, por aquele método primitivo de testar cada
solução e dascartar as que falham. Isso ainda era verdade com o uso da bilioteca
\technical{suspend}. Considere, por exemplo, a restrição \codigo{suspend:(X or Y), X = 0.}. Essa restrição tem a solução ${X=0,Y=1}$, mas, na forma como está escrita, a restrição
não nos permite encontrar essa solução (\codigo{X or Y} estará suspenso até que Y receba um valor, o
que não acontece, já que \funtor{or/2} só lida com variáveis instanciadas). Existem, no entanto, no
sistema \eclipse, bibliotecas que lidam com a restrição de forma ``ativa''
(isto é, fazem uso de propagações). Veremos como lidar com duas delas momentaneamente, a
\technical{ic\_symbolic} e a \technical{ic}.

Considere a seguinte situação (adaptada de \cite{antoni}):

Depois da queda do comunismo em Absurdolândia, vários clubes de debate ``Preto e Branco''
cresceram rapidamente pelo país. Eles eram clubes exclusivos: apenas antigos \enphasis{Colaboradores
Secretos} (do antigo Serviço de Segurança Comunista) ou antigos \technical{Oposicionistas Honrados}
(que costumavam serem caçados pelos antigos membros Serviço de Segurança Comunista). Esse tipo de
associação fez bastante sucesso, já que proveu um solo fértil para discussões contraditórias, amadas
pelo público, pela mídia televisiva e por jornalistas. Isso também impulsionou o consumo de todo
aquele tipo de bebida que tem uma merecida reputação de facilitar o entendimento de assuntos
complicados. A atratividade das discussões foi ainda mais realçada pelo conhecimento comum de que
\technical{Oposicionistas Honrados} sempre dizem a verdade, enquanto que \enphasis{Colaboradores
  Secertos} diziam alternadamente a verdade e a mentira. O bem conhecido tablóide local ``Notícias
da Cloaca'' delegou a um dos clubes um Jornalista Celebrado para fazer uma reportagem promovendo a
ideia de reconciliação entre os inimigos do passado. Infelizmente, o Jornalista Celebrado encontrou um
problema: no momento de sua chegada, o clube tinha apenas três membros, dos quais Membro1 e Membro2
argumentavam ferozmente, evidentemento porque pertenciam a diferentes grupos de membros. O
jornalista, não querendo importunar os adversários, perguntou ao Membro3, que não tomava parte no
argumento, se ele costumava ser um \enphasis{Oposicionista Honrado} ou um \enphasis{Colaborador
  Secreto}. Infelizmente, Membro3 já tinha tomado muito das bebidas supramencionadas e resmungou algo
ininteligível. O Jornalista Celebrado perguntou então aos dois membros restantes sobre o que o
Membro3 havia dito. Membro1, que talvez devido a alguma habilidade que havia praticado, pôde
entender a resposta do Membro3, afirmou que o Membro3 disse que havia sido um
\enphasis{Oposicionista Honrado}. No entanto, Membro2 primeiro disse que Membro3 foi um
\enphasis{Colaborador Secreto} e, então, adicionou que o Membro3 havia mentido. O Celebrado
Jornalista tem informação suficiente para inferir quem é quem?

Para resolver esse problema, faremos uso das bibliotecas ic e ic\_symbolic, a qual é uma adição à
biblioteca ic, implementando variáveis e restrições sobre sobre domínios simbólicos ordenados (como
já mencionado anteriormente). Para modelarmos esse problema, faremos uso das seguintes observações
básicas:

\begin{itemize}
  \item Membro1 e Membro3 disseram alguma coisa;
  \item Membro2 disse duas coisas;
  \item Cada coisa que foi dita pode ser verdadeira ou falsa;
  \item Sabemos o que Membro1 e Membro2 disseram, mas só sabemos o que o Membro3 possivelmente
    disse.
\end{itemize}

Assim, temos uma variável para cada membro, que é ou um \enphasis{Oposicionista Honrado} ou um
\enphasis{Colaborador Secreto}, assim como para cada coisa dita por eles (daqui para frente referida como
``resmungo''), que pode ser verdadeira ou falsa. Mais importante são as relações entre essas
variáveis.

Para a resolução do problema, notamos que os domínios a serem usados pela ic\_symbolic precisam ser
declarados, o que faremos por uso da construção \codigo{:- local
  domain(domain\_name($domain\_value_1$, ..., $domain\_value_n$))} em que ``domain\_name''
representa o nome do domínio e $domain\_value_i$ representa o i-ésimo valor (simbólico) no domínio.
O valor de cada variável de resmungo pode ser ``verdadeiro'' ou ``falso'', aqui representados pelos
valores aritméticos 0 e 1. O valor de cada variável de Membro pode receber os valores
``oposicionista\_honrado'' e ``colaborador\_secreto''. O que cada Membro disse é uma afirmação sobre
o grupo ao qual outro membro faz parte ou sobre a veracidade do que outro Membro disse. Essas
observações são traduzidas no seguinte código:

\inputminted{prolog}{../Exemplos/Cap10/prog1_pretoEbranco.ecl}

É um código simples e que não precisa de muitos comentários, mas cabe alguns:

\begin{itemize}
  \item As relações entre os Membros (termos simbólicos) são realizadas por restrições de
    ic\_symbolic (vale lembrar, os ``\#'' indicam que a restrição tem o significado usual, mas nos inteiros);
  \item As entre o que eles disseram (ou possivelmente disseram), por restrições aritméticas (de
    ic);
  \item Enquanto \codigo{[Membro\_1, Membro\_2, Membro\_3] \&:: membro\_do\_clube} indica o domínio
    das variáveis, \codigo{ic\_symbolic:indomain(Membro\_1)} faz a atribuição de valores (segundo as
    restrições);
  \item Em \codigo{resmungo\_unico(Membro, Verdade):- (Membro \&=} \\\codigo{oposicionista\_honrado) => Verdade},
    o símbolo ``\codigo{=>}'' é o de implicação como em lógica clássica;
  \item Restrições como \codigo{(Membro \&= colaborador\_secreto)} são reificadas, isto é, assumem
    um valor de ``verdadeiro'' ou ``falso'' (na prática, 0 ou 1);
  \item As linhas tais como \codigo{writeln("Membro\_1":Membro\_1)} escrevem ``Membro1~:~valor'',
    onde ``valor'' é o valor de Membro1.
\end{itemize}

Uma particularidade desse código é que ele resolve o problema sem a necessidade de
\technical{backtracking}, no que é chamado de \technical{backtracking-free search} (apesar de ser
uma propagação e não uma busca propriamente dita). Essa foi uma
situação excepcional, uma vez que geralmente é necessário fazer uma busca para se chegar à solução
(na verdade, mesmo quando não é necessário usar busca, sua introdução pode agilizar o processo).

  \begin{thebibliography}{2}

    \bibitem{antoni}
    Niederliński, Antoni,
    ``A gentle guide to constraint logical programming via Eclipse'',
    3rd edition, Jacek Skalmierski Computer Studio, Gliwice, 2014

  \end{thebibliography}

\end{document}
